/* ================================================================
   AI Learning Planner — style.css
   Architecture: Design Tokens → Base → Layout → Components → Utils
   Naming: BEM (Block__Element--Modifier)
   Fonts: Instrument Serif (display) + Plus Jakarta Sans (body)
   Theme: Dark luxury SaaS — deep space with violet/amber accents
   ================================================================ */


/* ================================================================
   1. DESIGN TOKENS (CSS Custom Properties)
   ================================================================ */
:root {
  /* — Color Palette — */
  --color-bg-base:        #080913;
  --color-bg-surface:     #0f1020;
  --color-bg-elevated:    #141628;
  --color-bg-overlay:     rgba(15, 16, 32, 0.92);

  --color-border:         rgba(255, 255, 255, 0.07);
  --color-border-subtle:  rgba(255, 255, 255, 0.04);
  --color-border-strong:  rgba(255, 255, 255, 0.13);
  --color-border-focus:   rgba(167, 139, 250, 0.55);

  --color-violet-50:   #ede9fe;
  --color-violet-200:  #ddd6fe;
  --color-violet-400:  #a78bfa;
  --color-violet-500:  #8b5cf6;
  --color-violet-600:  #7c3aed;
  --color-violet-900:  #1e1640;

  --color-amber-400:   #fbbf24;
  --color-amber-500:   #f59e0b;
  --color-amber-900:   #2d1f00;

  --color-green-400:   #4ade80;
  --color-green-900:   #052e16;

  --color-red-400:     #f87171;
  --color-red-900:     #2d0a0a;

  --color-text-primary:   #eeeaf8;
  --color-text-secondary: #8b85ab;
  --color-text-muted:     #4f4a6e;
  --color-text-disabled:  #2e2a45;

  /* — Spacing Scale (4px base) — */
  --space-1:   4px;
  --space-2:   8px;
  --space-3:   12px;
  --space-4:   16px;
  --space-5:   20px;
  --space-6:   24px;
  --space-8:   32px;
  --space-10:  40px;
  --space-12:  48px;
  --space-16:  64px;
  --space-20:  80px;

  /* — Typography Scale — */
  --font-display: 'Instrument Serif', Georgia, serif;
  --font-body:    'Plus Jakarta Sans', -apple-system, sans-serif;

  --text-xs:   0.72rem;   /* 11.5px */
  --text-sm:   0.8125rem; /* 13px   */
  --text-base: 0.9375rem; /* 15px   */
  --text-md:   1.0625rem; /* 17px   */
  --text-lg:   1.25rem;   /* 20px   */
  --text-xl:   1.5rem;    /* 24px   */
  --text-2xl:  2rem;      /* 32px   */
  --text-3xl:  2.75rem;   /* 44px   */
  --text-4xl:  3.5rem;    /* 56px   */

  /* — Border Radius — */
  --radius-sm:   8px;
  --radius-md:   14px;
  --radius-lg:   20px;
  --radius-xl:   28px;
  --radius-full: 9999px;

  /* — Shadows — */
  --shadow-sm:   0 1px 3px rgba(0,0,0,0.4), 0 1px 0 rgba(255,255,255,0.04) inset;
  --shadow-md:   0 4px 16px rgba(0,0,0,0.5), 0 1px 0 rgba(255,255,255,0.05) inset;
  --shadow-lg:   0 12px 40px rgba(0,0,0,0.6), 0 1px 0 rgba(255,255,255,0.06) inset;
  --shadow-xl:   0 24px 64px rgba(0,0,0,0.7), 0 1px 0 rgba(255,255,255,0.07) inset;
  --shadow-violet: 0 8px 32px rgba(139, 92, 246, 0.4);
  --shadow-violet-lg: 0 16px 48px rgba(139, 92, 246, 0.5);

  /* — Transitions — */
  --ease-out:   cubic-bezier(0.22, 1, 0.36, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --duration-fast:   150ms;
  --duration-base:   250ms;
  --duration-slow:   400ms;

  /* — Layout — */
  --page-max-width: 860px;
  --navbar-height:  64px;
}


/* ================================================================
   2. RESET & BASE
   ================================================================ */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-body);
  font-size: var(--text-base);
  color: var(--color-text-primary);
  background-color: var(--color-bg-base);
  line-height: 1.6;
  min-height: 100vh;
  overflow-x: hidden;
}

img, svg { display: block; }

button {
  font-family: inherit;
  cursor: pointer;
  border: none;
  background: none;
}

input, select, textarea {
  font-family: inherit;
  font-size: inherit;
}

a { text-decoration: none; color: inherit; }

:focus-visible {
  outline: 2px solid var(--color-violet-400);
  outline-offset: 3px;
  border-radius: var(--radius-sm);
}

/* Selection */
::selection {
  background: rgba(167, 139, 250, 0.25);
  color: var(--color-text-primary);
}


/* ================================================================
   3. AMBIENT BACKGROUND
   ================================================================ */
.ambient {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  overflow: hidden;
}

.ambient__orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(100px);
  opacity: 0.6;
}

.ambient__orb--1 {
  width: 700px;
  height: 700px;
  background: radial-gradient(circle, #2d1b69 0%, transparent 65%);
  top: -250px;
  left: -200px;
  animation: ambientFloat 18s ease-in-out infinite alternate;
}

.ambient__orb--2 {
  width: 600px;
  height: 600px;
  background: radial-gradient(circle, #1a0e50 0%, transparent 65%);
  bottom: -200px;
  right: -150px;
  animation: ambientFloat 24s ease-in-out infinite alternate-reverse;
}

.ambient__orb--3 {
  width: 400px;
  height: 400px;
  background: radial-gradient(circle, #3d2400 0%, transparent 65%);
  top: 35%;
  left: 55%;
  opacity: 0.35;
  animation: ambientFloat 30s ease-in-out infinite alternate;
}

.ambient__grid {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.018) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.018) 1px, transparent 1px);
  background-size: 48px 48px;
  mask-image: radial-gradient(ellipse 80% 80% at 50% 20%, black 30%, transparent 100%);
}

@keyframes ambientFloat {
  from { transform: translate(0, 0) scale(1);   }
  to   { transform: translate(30px, 25px) scale(1.06); }
}


/* ================================================================
   4. NAVBAR
   ================================================================ */
.navbar {
  position: sticky;
  top: 0;
  z-index: 200;
  height: var(--navbar-height);
  background: rgba(8, 9, 19, 0.8);
  backdrop-filter: blur(24px) saturate(160%);
  border-bottom: 1px solid var(--color-border);
}

.navbar__inner {
  max-width: var(--page-max-width);
  margin: 0 auto;
  padding: 0 var(--space-6);
  height: 100%;
  display: flex;
  align-items: center;
  gap: var(--space-6);
}

/* Brand */
.navbar__brand {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-shrink: 0;
}

/* Navbar logo – ensure full visibility */
.navbar__logo {
  width: auto;           /* Let it size naturally */
  min-width: 40px;       /* Minimum size, but allow growth */
  height: 40px;          /* Fixed height to keep navbar consistent */
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
}

.navbar__logo img {
  width: auto;           /* Let image keep its aspect ratio */
  height: 100%;          /* Fill the container's height */
  max-width: 120px;      /* Prevent it from getting too wide */
  object-fit: contain;   /* Ensure whole image fits without cropping */
  object-position: left center; /* Align to left if needed */
}

.navbar__wordmark {
  font-size: var(--text-base);
  font-weight: 700;
  letter-spacing: -0.03em;
  color: var(--color-text-primary);
}

.navbar__badge {
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-amber-400);
  background: rgba(245, 158, 11, 0.12);
  border: 1px solid rgba(245, 158, 11, 0.22);
  padding: 2px 8px;
  border-radius: var(--radius-full);
  letter-spacing: 0.04em;
}

/* Nav Links */
.navbar__nav {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  flex: 1;
}

.navbar__link {
  display: inline-flex;
  align-items: center;
  gap: 7px;
  padding: 7px var(--space-3);
  border-radius: var(--radius-sm);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-secondary);
  transition:
    background var(--duration-fast) var(--ease-out),
    color var(--duration-fast) var(--ease-out);
  position: relative;
}

.navbar__link:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
}

.navbar__link--active {
  color: var(--color-violet-400) !important;
  background: rgba(139, 92, 246, 0.1) !important;
}

.navbar__count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  font-size: var(--text-xs);
  font-weight: 700;
  background: var(--color-violet-600);
  color: white;
  border-radius: var(--radius-full);
  opacity: 0;
  transition: opacity var(--duration-base) var(--ease-out);
}

.navbar__count:not(:empty) { opacity: 1; }

/* Status Indicator */
.navbar__actions { margin-left: auto; }

.navbar__status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--color-text-muted);
}

.status__dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--color-green-400);
  box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.2);
  animation: statusPulse 2.5s ease-in-out infinite;
}

.navbar__status.is-loading .status__dot {
  background: var(--color-amber-400);
  box-shadow: 0 0 0 2px rgba(251, 191, 36, 0.2);
  animation: statusPulse 0.8s ease-in-out infinite;
}

.navbar__status.is-error .status__dot {
  background: var(--color-red-400);
  box-shadow: 0 0 0 2px rgba(248, 113, 113, 0.2);
  animation: none;
}

@keyframes statusPulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.4; }
}


/* ================================================================
   5. PAGE LAYOUT
   ================================================================ */
.page {
  max-width: var(--page-max-width);
  margin: 0 auto;
  padding: var(--space-12) var(--space-6) var(--space-20);
  position: relative;
  z-index: 1;
}

.page[hidden] { display: none; }

/* Page entrance animation */
.page--active {
  animation: pageEnter var(--duration-slow) var(--ease-out) both;
}

@keyframes pageEnter {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0);    }
}

/* Page Header (Library + Dashboard) */
.page-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: var(--space-4);
  margin-bottom: var(--space-8);
  flex-wrap: wrap;
}

.page-header__title {
  font-family: var(--font-display);
  font-size: var(--text-2xl);
  letter-spacing: -0.025em;
  line-height: 1.2;
  margin-bottom: var(--space-1);
}

.page-header__subtitle {
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
}


/* ================================================================
   6. HERO SECTION
   ================================================================ */
.hero {
  text-align: center;
  padding: var(--space-8) 0 var(--space-10);
}

.hero__eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 7px;
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--color-violet-400);
  background: rgba(139, 92, 246, 0.08);
  border: 1px solid rgba(139, 92, 246, 0.2);
  padding: 6px var(--space-3);
  border-radius: var(--radius-full);
  margin-bottom: var(--space-5);
}

.hero__title {
  font-family: var(--font-display);
  font-size: clamp(var(--text-3xl), 6vw, var(--text-4xl));
  line-height: 1.1;
  letter-spacing: -0.04em;
  color: var(--color-text-primary);
  margin-bottom: var(--space-5);
}

.hero__title em {
  font-style: italic;
  background: linear-gradient(135deg, var(--color-violet-400) 0%, var(--color-amber-400) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero__subtitle {
  font-size: var(--text-md);
  color: var(--color-text-secondary);
  font-weight: 300;
  line-height: 1.7;
  max-width: 520px;
  margin: 0 auto;
}


/* ================================================================
   7. CARD COMPONENT
   ================================================================ */
.card {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  backdrop-filter: blur(20px);
  padding: clamp(var(--space-6), 4vw, var(--space-8));
  margin-bottom: var(--space-5);
  transition:
    border-color var(--duration-base) var(--ease-out),
    box-shadow var(--duration-base) var(--ease-out);
}

.card:hover {
  border-color: var(--color-border-strong);
}


/* ================================================================
   8. FORM COMPONENTS
   ================================================================ */

/* Field wrapper */
.field {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-bottom: var(--space-5);
}

.field:last-child { margin-bottom: 0; }

.field-row {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: var(--space-4);
  margin-bottom: var(--space-5);
}

@media (max-width: 480px) { .field-row { grid-template-columns: 1fr; } }

/* Label */
.field__label {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-secondary);
  letter-spacing: 0.04em;
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.field__required {
  color: var(--color-violet-400);
  font-size: var(--text-xs);
}

/* Input wrapper (for icon) */
.field__control {
  position: relative;
}

.field__icon {
  position: absolute;
  right: var(--space-4);
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-text-muted);
  pointer-events: none;
}

/* Base input */
.field__input {
  width: 100%;
  padding: 13px var(--space-4);
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  color: var(--color-text-primary);
  font-size: var(--text-base);
  font-weight: 400;
  transition:
    border-color var(--duration-fast) var(--ease-out),
    background var(--duration-fast) var(--ease-out),
    box-shadow var(--duration-fast) var(--ease-out);
  outline: none;
  appearance: none;
  -webkit-appearance: none;
}

.field__input::placeholder {
  color: var(--color-text-muted);
  font-weight: 300;
}

.field__input:hover {
  border-color: var(--color-border-strong);
  background: rgba(255, 255, 255, 0.05);
}

.field__input:focus {
  border-color: var(--color-border-focus);
  background: rgba(167, 139, 250, 0.04);
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.12);
}

.field__input.is-error {
  border-color: rgba(248, 113, 113, 0.5);
  box-shadow: 0 0 0 3px rgba(248, 113, 113, 0.1);
}

/* Select */
.field__select-wrapper {
  position: relative;
}

.field__select {
  padding-right: var(--space-10);
  cursor: pointer;
}

.field__select-arrow {
  position: absolute;
  right: var(--space-3);
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-text-muted);
  pointer-events: none;
}

.field__select option {
  background: var(--color-bg-elevated);
  color: var(--color-text-primary);
}

/* Hint & Error */
.field__hint {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}

.field__error {
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--color-red-400);
  min-height: 16px;
  display: block;
}

/* Segmented control */
.field__segment {
  display: flex;
  gap: var(--space-2);
  flex-wrap: wrap;
}

.segment__btn {
  padding: 8px var(--space-4);
  border-radius: var(--radius-sm);
  border: 1px solid var(--color-border);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-secondary);
  background: transparent;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out);
}

.segment__btn:hover {
  border-color: var(--color-border-strong);
  color: var(--color-text-primary);
}

.segment__btn--active {
  background: rgba(139, 92, 246, 0.15);
  border-color: rgba(139, 92, 246, 0.4);
  color: var(--color-violet-400);
}

/* Form Actions */
.form-actions {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-top: var(--space-6);
  flex-wrap: wrap;
}


/* ================================================================
   9. BUTTON COMPONENTS
   ================================================================ */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-family: var(--font-body);
  font-size: var(--text-sm);
  font-weight: 600;
  line-height: 1;
  padding: 12px var(--space-5);
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  cursor: pointer;
  white-space: nowrap;
  transition:
    background var(--duration-fast) var(--ease-out),
    border-color var(--duration-fast) var(--ease-out),
    box-shadow var(--duration-fast) var(--ease-out),
    transform var(--duration-fast) var(--ease-spring),
    opacity var(--duration-fast) var(--ease-out);
  position: relative;
  overflow: hidden;
}

.btn:disabled {
  opacity: 0.45;
  cursor: not-allowed;
  pointer-events: none;
}

/* Primary */
.btn--primary {
  background: linear-gradient(135deg, var(--color-violet-500) 0%, var(--color-violet-600) 100%);
  color: #fff;
  box-shadow: var(--shadow-violet);
}

.btn--primary:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-violet-lg);
  filter: brightness(1.08);
}

.btn--primary:active {
  transform: translateY(0);
  filter: brightness(0.96);
}

/* Outline */
.btn--outline {
  background: transparent;
  border-color: var(--color-border-strong);
  color: var(--color-text-secondary);
}

.btn--outline:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
  border-color: rgba(255, 255, 255, 0.2);
}

/* Ghost */
.btn--ghost {
  background: transparent;
  color: var(--color-text-muted);
}

.btn--ghost:hover {
  background: rgba(255, 255, 255, 0.04);
  color: var(--color-text-secondary);
}

/* Sizes */
.btn--sm  { font-size: var(--text-xs); padding: 8px var(--space-3); border-radius: var(--radius-sm); }
.btn--lg  { font-size: var(--text-base); padding: 14px var(--space-6); border-radius: var(--radius-md); }

/* Loading state */
.btn__loader {
  display: none;
  width: 14px;
  height: 14px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}

.btn.is-loading .btn__label { opacity: 0.6; }
.btn.is-loading .btn__loader { display: block; }
.btn.is-loading .btn__icon  { display: none; }

/* Icon button */
.icon-btn {
  width: 30px;
  height: 30px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-muted);
  background: transparent;
  transition: all var(--duration-fast) var(--ease-out);
}

.icon-btn:hover {
  background: rgba(255,255,255,0.06);
  color: var(--color-text-secondary);
}

/* Text button */
.text-btn {
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-text-muted);
  background: transparent;
  padding: 0;
  transition: color var(--duration-fast) var(--ease-out);
}

.text-btn:hover { color: var(--color-violet-400); }

@keyframes spin { to { transform: rotate(360deg); } }


/* ================================================================
   10. CHIP / BADGE COMPONENTS
   ================================================================ */
.chip {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: var(--text-xs);
  font-weight: 600;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  padding: 4px 10px;
  border-radius: var(--radius-full);
  border: 1px solid transparent;
}

.chip--violet {
  color: var(--color-violet-400);
  background: rgba(139, 92, 246, 0.1);
  border-color: rgba(139, 92, 246, 0.22);
}

.chip--amber {
  color: var(--color-amber-400);
  background: rgba(245, 158, 11, 0.1);
  border-color: rgba(245, 158, 11, 0.22);
}

.chip--green {
  color: var(--color-green-400);
  background: rgba(74, 222, 128, 0.08);
  border-color: rgba(74, 222, 128, 0.2);
}


/* ================================================================
   11. RESULT CARD
   ================================================================ */
.result-card {
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
  border-color: rgba(139, 92, 246, 0.2);
}

@keyframes cardReveal {
  from { opacity: 0; transform: translateY(16px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0)    scale(1);    }
}

.result-card__header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-5);
  flex-wrap: wrap;
}

.result-card__header .icon-btn { margin-left: auto; }

.result-card__title {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  letter-spacing: -0.025em;
  line-height: 1.3;
  margin-bottom: var(--space-3);
}

.result-card__desc {
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  line-height: 1.75;
  margin-bottom: var(--space-5);
}

.result-card__stats {
  display: flex;
  gap: var(--space-4);
  margin-bottom: var(--space-6);
  flex-wrap: wrap;
}

.stat-pill {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--color-text-secondary);
  padding: 6px var(--space-3);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-full);
}

.stat-pill__icon { font-size: 12px; }

.result-card__actions {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex-wrap: wrap;
}


/* ================================================================
   12. LESSON PREVIEW (result card)
   ================================================================ */
.lesson-preview {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-bottom: var(--space-6);
}

.lesson-preview__item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: 10px var(--space-3);
  background: rgba(255,255,255,0.025);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-sm);
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  transition: all var(--duration-fast) var(--ease-out);
  animation: itemSlide var(--duration-base) var(--ease-out) both;
}

.lesson-preview__item:hover {
  background: rgba(255,255,255,0.045);
  color: var(--color-text-primary);
}

@keyframes itemSlide {
  from { opacity: 0; transform: translateX(-8px); }
  to   { opacity: 1; transform: translateX(0);    }
}

.lesson-preview__num {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: rgba(139, 92, 246, 0.15);
  color: var(--color-violet-400);
  font-size: var(--text-xs);
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
}

.lesson-preview__more {
  opacity: 0.45;
  font-style: italic;
}


/* ================================================================
   13. LIBRARY COMPONENTS
   ================================================================ */

/* Toolbar */
.library-toolbar {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  margin-bottom: var(--space-6);
  flex-wrap: wrap;
}

.library-toolbar__meta {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  font-weight: 500;
  margin-left: auto;
}

/* Search */
.search-field {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: 10px var(--space-4);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  flex: 1;
  max-width: 320px;
  transition: border-color var(--duration-fast) var(--ease-out);
}

.search-field:focus-within {
  border-color: var(--color-border-focus);
}

.search-field svg { color: var(--color-text-muted); flex-shrink: 0; }

.search-field__input {
  background: transparent;
  border: none;
  outline: none;
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  width: 100%;
}

.search-field__input::placeholder { color: var(--color-text-muted); }

/* Library Grid */
.library-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
  gap: var(--space-4);
  
}

/* Course Card */
.course-card {
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  padding: var(--space-5);
  cursor: pointer;
  transition:
    transform var(--duration-base) var(--ease-spring),
    border-color var(--duration-base) var(--ease-out),
    box-shadow var(--duration-base) var(--ease-out);
  animation: cardEnter var(--duration-base) var(--ease-out) both;
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  position: relative;
  overflow: hidden;
}

.course-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(139,92,246,0.05) 0%, transparent 60%);
  opacity: 0;
  transition: opacity var(--duration-base) var(--ease-out);
}

.course-card:hover {
  transform: translateY(-3px);
  border-color: rgba(139, 92, 246, 0.3);
  box-shadow: 0 20px 48px rgba(0,0,0,0.65), 0 0 0 1px rgba(139,92,246,0.12);
}

.course-card:hover::before { opacity: 1; }

@keyframes cardEnter {
  from { opacity: 0; transform: translateY(12px); }
  to   { opacity: 1; transform: translateY(0);    }
}

.course-card__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: var(--space-2);
}

.course-card__difficulty {
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-text-muted);
  text-transform: capitalize;
}

.course-card__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
  letter-spacing: -0.015em;
  line-height: 1.3;
  color: var(--color-text-primary);
}

.course-card__meta {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}

.course-card__dot {
  width: 3px;
  height: 3px;
  border-radius: 50%;
  background: currentColor;
  flex-shrink: 0;
}

/* Card Progress */
.card-progress__bar {
  height: 4px;
  background: rgba(255,255,255,0.07);
  border-radius: var(--radius-full);
  overflow: hidden;
  margin-top: auto;
}

.card-progress__fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-violet-500), var(--color-amber-400));
  border-radius: var(--radius-full);
  transition: width 0.6s var(--ease-out);
}

.card-progress__info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}

.card-progress__pct {
  font-weight: 600;
  color: var(--color-violet-400);
}

.course-card__remaining {
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-amber-400);
  display: flex;
  align-items: center;
  gap: 4px;
}


/* ================================================================
   14. DASHBOARD COMPONENTS
   ================================================================ */

/* Stats row */
.dashboard-stats {
  display: flex;
  gap: var(--space-3);
  margin-bottom: var(--space-6);
  flex-wrap: wrap;
}

.stat-card {
  flex: 1;
  min-width: 100px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-4);
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.stat-card__value {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  letter-spacing: -0.03em;
  color: var(--color-text-primary);
}

.stat-card__label {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  font-weight: 500;
}

/* Progress Ring */
.progress-ring {
  position: relative;
  width: 80px;
  height: 80px;
  flex-shrink: 0;
}

.progress-ring__svg {
  width: 80px;
  height: 80px;
  transform: rotate(-90deg);
}

.progress-ring__track {
  fill: none;
  stroke: rgba(255,255,255,0.06);
  stroke-width: 6;
}

.progress-ring__fill {
  fill: none;
  stroke: url(#ringGradient);
  stroke-width: 6;
  stroke-linecap: round;
  stroke-dasharray: 175.929; /* 2πr = 2 * π * 28 */
  stroke-dashoffset: 175.929;
  transition: stroke-dashoffset 0.8s var(--ease-out);
}

.progress-ring__label {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--text-sm);
  font-weight: 700;
  color: var(--color-violet-400);
}

/* Progress Bar (full-width) */
.progress-bar {
  margin-bottom: var(--space-8);
}

.progress-bar__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-2);
}

.progress-bar__label {
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--color-text-muted);
}

.progress-bar__value {
  font-size: var(--text-sm);
  font-weight: 700;
  color: var(--color-violet-400);
}

.progress-bar__track {
  height: 6px;
  background: rgba(255,255,255,0.06);
  border-radius: var(--radius-full);
  overflow: hidden;
}

.progress-bar__fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-violet-500) 0%, var(--color-amber-400) 100%);
  border-radius: var(--radius-full);
  width: 0%;
  transition: width 0.7s var(--ease-out);
}

/* Lessons Section */
.lessons-section__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
  flex-wrap: wrap;
  gap: var(--space-2);
}

.lessons-section__title {
  font-size: var(--text-sm);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--color-text-muted);
}

.lessons-section__actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.divider {
  color: var(--color-text-muted);
  font-size: var(--text-xs);
}

/* Lesson Items */
.lessons-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.lesson-item {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  padding: var(--space-4) var(--space-5);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition:
    background var(--duration-fast) var(--ease-out),
    border-color var(--duration-fast) var(--ease-out),
    transform var(--duration-fast) var(--ease-spring);
  animation: itemEnter var(--duration-base) var(--ease-out) both;
}

@keyframes itemEnter {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0);   }
}

.lesson-item:hover {
  background: rgba(255,255,255,0.04);
  border-color: var(--color-border-strong);
  transform: translateX(3px);
}

.lesson-item.is-complete {
  background: rgba(74, 222, 128, 0.03);
  border-color: rgba(74, 222, 128, 0.12);
  opacity: 0.72;
}

.lesson-item.is-complete:hover {
  opacity: 1;
}

/* Checkbox */
.lesson-item__check {
  flex-shrink: 0;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 2px solid var(--color-border-strong);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--duration-base) var(--ease-spring);
  background: transparent;
}

.lesson-item.is-complete .lesson-item__check {
  background: var(--color-green-400);
  border-color: transparent;
  animation: checkBounce var(--duration-slow) var(--ease-spring);
}

@keyframes checkBounce {
  0%  { transform: scale(0.6); }
  60% { transform: scale(1.2); }
  100%{ transform: scale(1);   }
}

.lesson-item__check-icon {
  color: var(--color-bg-base);
  font-size: 11px;
  font-weight: 800;
  opacity: 0;
  transition: opacity var(--duration-fast) var(--ease-out);
}

.lesson-item.is-complete .lesson-item__check-icon { opacity: 1; }

/* Lesson content */
.lesson-item__content { flex: 1; min-width: 0; }

.lesson-item__title {
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-primary);
  margin-bottom: 2px;
  transition: color var(--duration-fast) var(--ease-out);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.lesson-item.is-complete .lesson-item__title {
  text-decoration: line-through;
  color: var(--color-text-muted);
}

.lesson-item__module {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}

/* Status tag */
.lesson-item__tag {
  flex-shrink: 0;
  font-size: var(--text-xs);
  font-weight: 600;
  padding: 3px 10px;
  border-radius: var(--radius-full);
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.lesson-item__tag--pending {
  background: rgba(139, 92, 246, 0.1);
  border: 1px solid rgba(139, 92, 246, 0.2);
  color: var(--color-violet-400);
}

.lesson-item__tag--done {
  background: rgba(74, 222, 128, 0.08);
  border: 1px solid rgba(74, 222, 128, 0.2);
  color: var(--color-green-400);
}


/* ================================================================
   15. EMPTY STATE
   ================================================================ */
.empty-state {
  text-align: center;
  padding: var(--space-16) var(--space-6);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-4);
}

.empty-state__visual { margin-bottom: var(--space-2); }

.empty-state__title {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  letter-spacing: -0.02em;
}

.empty-state__text {
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  max-width: 320px;
  line-height: 1.7;
}


/* ================================================================
   16. LOADING SKELETON
   ================================================================ */
.skeleton {
  background: linear-gradient(
    90deg,
    rgba(255,255,255,0.04) 25%,
    rgba(255,255,255,0.08) 50%,
    rgba(255,255,255,0.04) 75%
  );
  background-size: 200% 100%;
  border-radius: var(--radius-sm);
  animation: shimmer 1.5s ease-in-out infinite;
}

@keyframes shimmer {
  from { background-position: 200% 0; }
  to   { background-position: -200% 0; }
}

.skeleton--text { height: 14px; margin-bottom: var(--space-2); }
.skeleton--title { height: 24px; width: 60%; margin-bottom: var(--space-3); }
.skeleton--card {
  height: 160px;
  border-radius: var(--radius-lg);
  margin-bottom: var(--space-3);
}


/* ================================================================
   17. BACK LINK
   ================================================================ */
.back-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.07em;
  margin-bottom: var(--space-2);
  transition: color var(--duration-fast) var(--ease-out);
  padding: 0;
}

.back-link:hover { color: var(--color-violet-400); }


/* ================================================================
   18. TOAST NOTIFICATION
   ================================================================ */
.toast {
  position: fixed;
  bottom: var(--space-8);
  left: 50%;
  transform: translateX(-50%) translateY(calc(100% + 40px));
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-strong);
  backdrop-filter: blur(24px);
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  font-weight: 500;
  padding: 12px var(--space-5);
  border-radius: var(--radius-full);
  box-shadow: var(--shadow-xl);
  z-index: 999;
  white-space: nowrap;
  transition: transform var(--duration-slow) var(--ease-spring);
  pointer-events: none;
}

.toast.is-visible {
  transform: translateX(-50%) translateY(0);
}

.toast--success { border-color: rgba(74, 222, 128, 0.3); }
.toast--error   { border-color: rgba(248, 113, 113, 0.3); }


/* ================================================================
   19. UTILITIES
   ================================================================ */
.hidden  { display: none !important; }
.sr-only {
  position: absolute;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden;
  clip: rect(0,0,0,0);
  border: 0;
}


/* ================================================================
   20. SCROLLBAR
   ================================================================ */
::-webkit-scrollbar       { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.1);
  border-radius: var(--radius-full);
}
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.18); }


/* ================================================================
   21. RESPONSIVE
   ================================================================ */
@media (max-width: 640px) {
  .form-actions     { flex-direction: column; }
  .btn              { justify-content: center; width: 100%; }
  .btn--ghost       { width: auto; }
  .page-header      { flex-direction: column; }
  .dashboard-stats  { flex-direction: column; }
  .result-card__actions { flex-direction: column; }
  .progress-ring    { display: none; }
  .navbar__status .status__label { display: none; }
  .library-toolbar  { flex-direction: column; align-items: stretch; }
  .search-field     { max-width: 100%; }
}

@media (max-width: 400px) {
  :root { --page-max-width: 100%; }
  .page { padding-left: var(--space-4); padding-right: var(--space-4); }
}


/* ================================================================
   22. APP LOADER (full-screen, shown during auth state resolution)
   ================================================================ */
.app-loader {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: var(--color-bg-base);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-4);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}

.app-loader.is-visible {
  opacity: 1;
  pointer-events: all;
}

.app-loader__ring {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(167, 139, 250, 0.2);
  border-top-color: var(--color-violet-400);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

.app-loader__text {
  font-size: var(--text-sm);
  color: var(--color-text-muted);
  font-weight: 500;
}


/* ================================================================
   23. AUTH PAGE
   ================================================================ */
.page--auth {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: var(--space-6);
}

.auth-card {
  width: 100%;
  max-width: 420px;
  margin: 0 auto;
}

.auth-card__brand {
  text-align: center;
  margin-bottom: var(--space-6);
}

.auth-card__logo {
  width: 52px;
  height: 52px;
  background: rgba(139, 92, 246, 0.1);
  border: 1px solid rgba(139, 92, 246, 0.25);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto var(--space-4);
}

.auth-card__title {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  letter-spacing: -0.025em;
  margin-bottom: var(--space-2);
}

.auth-card__subtitle {
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  line-height: 1.6;
}

/* Auth Tabs */
.auth-tabs {
  display: flex;
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: 3px;
  margin-bottom: var(--space-6);
  gap: 3px;
}

.auth-tab {
  flex: 1;
  padding: 9px;
  border-radius: calc(var(--radius-md) - 3px);
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-muted);
  background: transparent;
  transition: all var(--duration-fast) var(--ease-out);
}

.auth-tab:hover { color: var(--color-text-secondary); }

.auth-tab--active {
  background: var(--color-bg-elevated);
  color: var(--color-text-primary);
  box-shadow: var(--shadow-sm);
}

/* Google button */
.btn--google {
  width: 100%;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--color-border-strong);
  color: var(--color-text-primary);
  font-weight: 600;
  justify-content: center;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
  transition: all var(--duration-fast) var(--ease-out);
}

.btn--google:hover {
  background: rgba(255, 255, 255, 0.09);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-1px);
}

/* Divider */
.auth-divider {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin: var(--space-4) 0;
  color: var(--color-text-muted);
  font-size: var(--text-xs);
}

.auth-divider::before,
.auth-divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--color-border);
}

/* Forgot / meta row */
.auth-meta {
  display: flex;
  justify-content: flex-end;
  margin-bottom: var(--space-4);
  margin-top: calc(var(--space-2) * -1);
}

/* Submit button (full width in auth) */
.auth-submit { width: 100%; justify-content: center; margin-top: var(--space-2); }

/* General error message */
.auth-error {
  text-align: center;
  display: block;
  margin-top: var(--space-3);
  min-height: 18px;
}


/* ================================================================
   24. USER MENU (navbar avatar + dropdown)
   ================================================================ */
.user-menu {
  position: relative;
}

.user-menu__trigger {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.user-avatar {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--color-violet-500), var(--color-amber-500));
  color: white;
  font-size: var(--text-sm);
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid rgba(255,255,255,0.1);
  overflow: hidden;
  cursor: pointer;
  transition: border-color var(--duration-fast) var(--ease-out);
}

.user-avatar:hover { border-color: rgba(167, 139, 250, 0.5); }

/* Dropdown */
.user-menu__dropdown {
  position: absolute;
  top: calc(100% + 10px);
  right: 0;
  min-width: 220px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-strong);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-xl);
  backdrop-filter: blur(24px);
  overflow: hidden;
  animation: dropdownOpen var(--duration-base) var(--ease-spring) both;
  z-index: 300;
}

@keyframes dropdownOpen {
  from { opacity: 0; transform: translateY(-8px) scale(0.96); }
  to   { opacity: 1; transform: translateY(0)    scale(1);    }
}

.user-menu__info {
  padding: var(--space-4);
}

.user-menu__name {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-menu__email {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-menu__divider {
  height: 1px;
  background: var(--color-border);
}

.user-menu__item {
  width: 100%;
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-secondary);
  background: transparent;
  text-align: left;
  transition: all var(--duration-fast) var(--ease-out);
  cursor: pointer;
}

.user-menu__item:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
}

.user-menu__item--danger { color: var(--color-red-400); }
.user-menu__item--danger:hover {
  background: var(--color-red-900);
  color: var(--color-red-400);
}


/* ================================================================
   25. QUIZ MODAL
   ================================================================ */
.quiz-modal {
  position: fixed; inset: 0; z-index: 500;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.quiz-modal.is-open { opacity: 1; pointer-events: all; }

.quiz-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}

.quiz-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 600px; max-height: 88vh;
  overflow-y: auto; margin: 0;
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}

.quiz-modal__header {
  display: flex; align-items: flex-start; justify-content: space-between;
  gap: var(--space-4); margin-bottom: var(--space-5);
}
.quiz-modal__title {
  font-family: var(--font-display); font-size: var(--text-lg);
  letter-spacing: -0.02em; line-height: 1.3;
}

/* Loading state */
.quiz-loading {
  display: flex; flex-direction: column; align-items: center;
  gap: var(--space-4); padding: var(--space-10) 0;
  color: var(--color-text-secondary); font-size: var(--text-sm);
}
.quiz-loading__spinner {
  width: 32px; height: 32px;
  border: 3px solid rgba(167,139,250,0.2);
  border-top-color: var(--color-violet-400);
  border-radius: 50%; animation: spin 0.8s linear infinite;
}

/* Error */
.quiz-error {
  padding: var(--space-8) 0; text-align: center;
  color: var(--color-text-secondary); font-size: var(--text-sm);
}

/* Questions */
.quiz-questions { display: flex; flex-direction: column; gap: var(--space-6); margin-bottom: var(--space-6); }

.quiz-question__text {
  font-size: var(--text-sm); font-weight: 500; margin-bottom: var(--space-3);
  display: flex; gap: var(--space-2); align-items: flex-start; line-height: 1.6;
}
.quiz-question__num {
  flex-shrink: 0; font-size: var(--text-xs); font-weight: 700;
  color: var(--color-violet-400); background: rgba(139,92,246,0.1);
  border: 1px solid rgba(139,92,246,0.2); padding: 2px 7px;
  border-radius: var(--radius-full); margin-top: 1px;
}

/* Options */
.quiz-options { display: flex; flex-direction: column; gap: var(--space-2); }

.quiz-option {
  display: flex; align-items: center; gap: var(--space-3);
  padding: 10px var(--space-4);
  background: rgba(255,255,255,0.03); border: 1px solid var(--color-border);
  border-radius: var(--radius-sm); cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out);
}
.quiz-option:hover { background: rgba(255,255,255,0.06); border-color: var(--color-border-strong); }
.quiz-option__radio { display: none; }
.quiz-option__letter {
  flex-shrink: 0; width: 24px; height: 24px; border-radius: 50%;
  background: rgba(255,255,255,0.06); border: 1px solid var(--color-border);
  display: flex; align-items: center; justify-content: center;
  font-size: var(--text-xs); font-weight: 700; color: var(--color-text-muted);
  transition: all var(--duration-fast) var(--ease-out);
}
.quiz-option__text { font-size: var(--text-sm); color: var(--color-text-secondary); }

/* Selected state (via JS class or :has) */
.quiz-option:has(input:checked) {
  border-color: rgba(139,92,246,0.4);
  background: rgba(139,92,246,0.08);
}
.quiz-option:has(input:checked) .quiz-option__letter {
  background: var(--color-violet-600); border-color: transparent; color: #fff;
}

/* Result states */
.quiz-option--correct {
  border-color: rgba(74,222,128,0.4) !important;
  background: rgba(74,222,128,0.06) !important;
}
.quiz-option--correct .quiz-option__letter {
  background: var(--color-green-400) !important; border-color: transparent !important; color: #000 !important;
}
.quiz-option--wrong {
  border-color: rgba(248,113,113,0.4) !important;
  background: rgba(248,113,113,0.06) !important;
  opacity: 0.75;
}
.quiz-option--wrong .quiz-option__letter {
  background: var(--color-red-400) !important; border-color: transparent !important; color: #fff !important;
}

/* Explanation */
.quiz-explanation {
  margin-top: var(--space-2); padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-sm); font-size: var(--text-xs); line-height: 1.6;
}
.quiz-explanation--correct { background: rgba(74,222,128,0.06); border: 1px solid rgba(74,222,128,0.2); color: var(--color-green-400); }
.quiz-explanation--wrong   { background: rgba(248,113,113,0.06); border: 1px solid rgba(248,113,113,0.2); color: var(--color-red-400); }

/* Footer */
.quiz-footer {
  display: flex; align-items: center; justify-content: space-between;
  gap: var(--space-4); flex-wrap: wrap;
  padding-top: var(--space-5); border-top: 1px solid var(--color-border);
}

/* Score / Result */
.quiz-result { display: flex; align-items: center; gap: var(--space-3); }
.quiz-result__score {
  font-family: var(--font-display); font-size: var(--text-lg);
  letter-spacing: -0.03em; font-weight: 700;
}
.quiz-result__score--pass { color: var(--color-green-400); }
.quiz-result__score--ok   { color: var(--color-amber-400); }
.quiz-result__score--fail { color: var(--color-red-400); }
.quiz-result__label { font-size: var(--text-sm); color: var(--color-text-secondary); }

/* Quiz button on lesson items */
.quiz-btn {
  display: inline-flex; align-items: center; gap: 5px;
  font-size: var(--text-xs); font-weight: 600;
  color: var(--color-violet-400);
  background: rgba(139,92,246,0.1); border: 1px solid rgba(139,92,246,0.25);
  padding: 4px 10px; border-radius: var(--radius-full);
  cursor: pointer; transition: all var(--duration-fast) var(--ease-out);
  flex-shrink: 0;
}
.quiz-btn:hover { background: rgba(139,92,246,0.2); border-color: rgba(139,92,246,0.45); }

.lesson-item__actions { display: flex; align-items: center; gap: var(--space-2); flex-shrink: 0; }

/* AI stat pill */
.stat-pill--ai {
  color: var(--color-violet-400);
  background: rgba(139,92,246,0.1);
  border-color: rgba(139,92,246,0.25);
}
/* ================================================================
   26. LESSON MODAL
   ================================================================ */
.lesson-modal,
.quiz-modal,
.project-modal {
  position: fixed; inset: 0; z-index: 500;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.lesson-modal.is-open,
.quiz-modal.is-open,
.project-modal.is-open {
  opacity: 1; pointer-events: all;
}

.lesson-modal__backdrop,
.quiz-modal__backdrop,
.project-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}

.lesson-modal__box,
.quiz-modal__box,
.project-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 800px; max-height: 90vh;
  overflow-y: auto; margin: 0;
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}

.lesson-modal__header,
.quiz-modal__header,
.project-modal__header {
  display: flex; align-items: flex-start; justify-content: space-between;
  gap: var(--space-4); margin-bottom: var(--space-5);
}
.lesson-modal__title,
.quiz-modal__title,
.project-modal__title {
  font-family: var(--font-display); font-size: var(--text-xl);
  letter-spacing: -0.02em; line-height: 1.3;
}

.lesson-modal__body {
  font-size: var(--text-base);
  line-height: 1.8;
  color: var(--color-text-primary);
}
.lesson-modal__body h1,
.lesson-modal__body h2,
.lesson-modal__body h3 {
  margin: var(--space-4) 0 var(--space-2);
  font-family: var(--font-display);
}
.lesson-modal__body pre {
  background: rgba(0,0,0,0.3);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  padding: var(--space-4);
  overflow-x: auto;
  font-family: monospace;
  font-size: var(--text-sm);
}
.lesson-modal__body code {
  background: rgba(0,0,0,0.2);
  padding: 2px 4px;
  border-radius: 4px;
  font-family: monospace;
}

/* Day header */
.day-header {
  margin: var(--space-5) 0 var(--space-2);
  padding-bottom: var(--space-2);
  border-bottom: 1px solid var(--color-border);
}
.day-header h4 {
  font-size: var(--text-md);
  font-weight: 600;
  color: var(--color-text-secondary);
}

/* ================================================================
   THEME TOGGLE BUTTON
   ================================================================ */
.theme-toggle {
  background: none;
  border: none;
  font-size: 1.3rem;
  cursor: pointer;
  padding: 0.3rem 0.6rem;
  color: var(--color-text-primary);
  transition: all 0.2s ease;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  margin-right: 0.5rem;
}

.theme-toggle:hover {
  background: rgba(128, 128, 128, 0.1);
  transform: scale(1.05);
}

/* Ensure navbar actions layout */
.navbar__actions {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
/* ================================================================
   Enhanced Lesson Modal with Action Cards and Library
   ================================================================ */

.lesson-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}

.lesson-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  letter-spacing: -0.02em;
  line-height: 1.3;
}

.lesson-modal__header-actions {
  display: flex;
  gap: var(--space-2);
}

/* Action Cards */
.action-cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-4);
  margin: var(--space-6) 0;
}

.action-card {
  background: var(--color-bg-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  transition: border-color var(--duration-fast) var(--ease-out);
}

.action-card:hover {
  border-color: var(--color-border-strong);
}

.card-title {
  font-size: var(--text-md);
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: var(--space-1);
}

.card-description {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  margin-bottom: var(--space-3);
}

.card-input {
  width: 100%;
  padding: var(--space-2) var(--space-3);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  resize: vertical;
  margin-bottom: var(--space-3);
}

.card-input:focus {
  outline: none;
  border-color: var(--color-violet-400);
}

.card-actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-top: var(--space-2);
}

.loading-indicator,
.saved-indicator {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}

.answer-box {
  margin-top: var(--space-3);
  padding: var(--space-3);
  background: rgba(74, 222, 128, 0.05);
  border: 1px solid rgba(74, 222, 128, 0.2);
  border-radius: var(--radius-sm);
  font-size: var(--text-sm);
  color: var(--color-text-primary);
}

/* Quiz options */
.quiz-options {
  display: flex;
  justify-content: space-around;
  margin-bottom: var(--space-3);
}

.quiz-options label {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  cursor: pointer;
}

.quiz-options input[type="radio"] {
  accent-color: var(--color-violet-400);
  width: 14px;
  height: 14px;
}

/* Lesson Library */
.lesson-library {
  margin-top: var(--space-6);
  border-top: 1px solid var(--color-border);
  padding-top: var(--space-4);
}

.library-title {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--space-3);
}

.library-tabs {
  display: flex;
  gap: var(--space-2);
  margin-bottom: var(--space-3);
  border-bottom: 1px solid var(--color-border);
}

.tab-btn {
  padding: var(--space-2) var(--space-4);
  background: transparent;
  border: none;
  color: var(--color-text-muted);
  font-size: var(--text-sm);
  font-weight: 500;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out);
  border-bottom: 2px solid transparent;
}

.tab-btn:hover {
  color: var(--color-text-secondary);
}

.tab-btn.active {
  color: var(--color-violet-400);
  border-bottom-color: var(--color-violet-400);
}

.library-panes {
  min-height: 150px;
  max-height: 250px;
  overflow-y: auto;
}

.tab-pane {
  display: none;
}

.tab-pane.active {
  display: block;
}

.library-item {
  padding: var(--space-2) var(--space-3);
  margin-bottom: var(--space-2);
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
}

.item-question {
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 2px;
}

.item-answer {
  color: var(--color-text-secondary);
  margin-bottom: 2px;
}

.item-date {
  color: var(--color-text-muted);
  font-size: 0.7rem;
  margin-top: 2px;
}

.quiz-score {
  font-weight: 600;
  color: var(--color-violet-400);
}

.notes-content {
  color: var(--color-text-primary);
  white-space: pre-wrap;
}

.empty-message {
  color: var(--color-text-muted);
  font-style: italic;
  padding: var(--space-2) 0;
}

/* Light theme adjustments */
[data-theme="light"] .action-card {
  background: #ffffff;
}

[data-theme="light"] .card-input {
  background: #f9fafb;
}

[data-theme="light"] .library-item {
  background: rgba(0,0,0,0.02);
}
/* ================================================================
   LIGHT THEME OVERRIDES
   ================================================================ */
[data-theme="light"] {
  --color-bg-base: #f9fafb;
  --color-bg-surface: #ffffff;
  --color-bg-elevated: #f3f4f6;
  --color-bg-overlay: rgba(255, 255, 255, 0.95);

  --color-border: rgba(0, 0, 0, 0.08);
  --color-border-subtle: rgba(0, 0, 0, 0.04);
  --color-border-strong: rgba(0, 0, 0, 0.12);
  --color-border-focus: rgba(99, 102, 241, 0.5);

  --color-violet-400: #8b5cf6;
  --color-violet-500: #7c3aed;
  --color-violet-600: #6d28d9;
  --color-amber-400: #f59e0b;
  --color-amber-500: #d97706;
  --color-green-400: #10b981;
  --color-red-400: #ef4444;

  --color-text-primary: #111827;
  --color-text-secondary: #4b5563;
  --color-text-muted: #6b7280;
  --color-text-disabled: #9ca3af;

  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --shadow-violet: 0 8px 32px rgba(139, 92, 246, 0.15);
  --shadow-violet-lg: 0 16px 48px rgba(139, 92, 246, 0.2);
}

/* Light mode specific component styles */
[data-theme="light"] .navbar {
  background: rgba(255, 255, 255, 0.8);
  border-bottom-color: rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .card,
[data-theme="light"] .course-card,
[data-theme="light"] .lesson-item,
[data-theme="light"] .quiz-modal__box,
[data-theme="light"] .lesson-modal__box,
[data-theme="light"] .project-modal__box {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .field__input {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
  color: #111827;
}

[data-theme="light"] .field__input:hover {
  background: #f9fafb;
}

[data-theme="light"] .field__input:focus {
  background: #ffffff;
  border-color: var(--color-violet-400);
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

[data-theme="light"] .btn--primary {
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  color: white;
}

[data-theme="light"] .btn--outline {
  border-color: rgba(0, 0, 0, 0.2);
  color: #4b5563;
}

[data-theme="light"] .btn--outline:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #111827;
}

[data-theme="light"] .btn--ghost {
  color: #6b7280;
}

[data-theme="light"] .btn--ghost:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #4b5563;
}

[data-theme="light"] .chip--violet {
  background: rgba(139, 92, 246, 0.1);
  border-color: rgba(139, 92, 246, 0.2);
  color: #7c3aed;
}

[data-theme="light"] .chip--amber {
  background: rgba(245, 158, 11, 0.1);
  border-color: rgba(245, 158, 11, 0.2);
  color: #b45309;
}

[data-theme="light"] .progress-ring__track {
  stroke: rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .stat-card {
  background: #f9fafb;
  border-color: rgba(0, 0, 0, 0.08);
}

[data-theme="light"] .lesson-item.is-complete {
  background: rgba(16, 185, 129, 0.05);
  border-color: rgba(16, 185, 129, 0.2);
}

[data-theme="light"] .lesson-item__tag--pending {
  background: rgba(139, 92, 246, 0.1);
  border-color: rgba(139, 92, 246, 0.2);
  color: #7c3aed;
}

[data-theme="light"] .lesson-item__tag--done {
  background: rgba(16, 185, 129, 0.1);
  border-color: rgba(16, 185, 129, 0.2);
  color: #059669;
}

[data-theme="light"] .quiz-option {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
}

[data-theme="light"] .quiz-option:hover {
  background: #f9fafb;
}

[data-theme="light"] .quiz-option:has(input:checked) {
  background: rgba(139, 92, 246, 0.05);
  border-color: rgba(139, 92, 246, 0.3);
}

[data-theme="light"] .user-avatar {
  background: linear-gradient(135deg, #8b5cf6, #f59e0b);
  color: white;
}

[data-theme="light"] .toast {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
  color: #111827;
}

[data-theme="light"] .ambient {
  opacity: 0.3; /* Reduce ambient effect in light mode */
}
/* ================================================================
   AI Learning Planner — style.css (updated with new features)
   ================================================================ */

/* ... (your existing CSS up to the end of section 25) ... */

/* ================================================================
   26. LESSON MODAL (already present – we'll add history styles after it)
   ================================================================ */
/* (your existing lesson modal styles) */

/* ================================================================
   27. STREAK DISPLAY (new)
   ================================================================ */
.streak-display {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-amber-400);
  background: rgba(245, 158, 11, 0.1);
  border: 1px solid rgba(245, 158, 11, 0.2);
  padding: 4px 10px;
  border-radius: var(--radius-full);
  margin-right: var(--space-2);
}

/* ================================================================
   28. DOUBT & QUIZ ACTION BUTTONS (new)
   ================================================================ */
.lesson-action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: var(--radius-sm);
  background: transparent;
  border: 1px solid var(--color-border);
  color: var(--color-text-muted);
  font-size: 14px;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out);
}

.lesson-action-btn:hover {
  background: rgba(255, 255, 255, 0.06);
  color: var(--color-text-primary);
  border-color: var(--color-border-strong);
}

[data-theme="light"] .lesson-action-btn:hover {
  background: rgba(0, 0, 0, 0.04);
}

/* Adjust lesson-item actions layout */
.lesson-item__actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-shrink: 0;
}

/* If you want the doubt and quiz buttons to appear before the status tag */
.lesson-item__actions .lesson-action-btn {
  order: 1;
}
.lesson-item__actions .lesson-item__tag {
  order: 2;
}

/* ================================================================
   29. LESSON MODAL HISTORY SECTIONS (new)
   ================================================================ */
.lesson-modal__history {
  margin-top: var(--space-6);
  border-top: 1px solid var(--color-border);
  padding-top: var(--space-4);
}

.lesson-modal__history h4 {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-secondary);
  margin-bottom: var(--space-2);
}

.doubts-history,
.quizzes-history {
  max-height: 200px;
  overflow-y: auto;
  margin-bottom: var(--space-4);
  padding: var(--space-2);
  background: rgba(255, 255, 255, 0.02);
  border-radius: var(--radius-sm);
}

.doubt-history-item,
.quiz-history-item {
  padding: var(--space-2) var(--space-3);
  margin-bottom: var(--space-2);
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
}

.doubt-history-item p {
  margin-bottom: 4px;
}

.doubt-history-item small {
  color: var(--color-text-muted);
}

.quiz-history-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* ================================================================
   30. DOUBT MODAL (new)
   ================================================================ */
.doubt-modal,
.quiz-options-modal {
  position: fixed; inset: 0; z-index: 500;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.doubt-modal.is-open,
.quiz-options-modal.is-open {
  opacity: 1; pointer-events: all;
}
.doubt-modal__backdrop,
.quiz-options-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.doubt-modal__box,
.quiz-options-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 500px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}
.doubt-modal__header,
.quiz-options-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}
.doubt-modal__title,
.quiz-options-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
}
.doubt-question-input {
  width: 100%;
  padding: var(--space-3);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  resize: vertical;
  margin-bottom: var(--space-4);
}
.doubt-question-input:focus {
  outline: none;
  border-color: var(--color-violet-400);
}
.doubt-answer {
  padding: var(--space-4);
  background: rgba(74, 222, 128, 0.05);
  border: 1px solid rgba(74, 222, 128, 0.2);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  margin-bottom: var(--space-4);
  white-space: pre-wrap;
}
.doubt-loading {
  text-align: center;
  color: var(--color-text-muted);
  padding: var(--space-4);
}
.doubt-footer,
.quiz-options-footer {
  display: flex;
  justify-content: flex-end;
  gap: var(--space-3);
}

/* ================================================================
   31. QUIZ OPTIONS MODAL (new)
   ================================================================ */
.quiz-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-bottom: var(--space-4);
}
.quiz-options label {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  cursor: pointer;
}
.quiz-options input[type="radio"] {
  accent-color: var(--color-violet-400);
  width: 16px;
  height: 16px;
}

/* ================================================================
   32. THEME TOGGLE BUTTON (already present – keep as is)
   ================================================================ */

/* ================================================================
   33. LIGHT THEME OVERRIDES (already present – keep as is)
   ================================================================ */

/* ... rest of your existing light theme overrides remain unchanged */
/* ================================================================
   AI Learning Planner — style.css (updated with new features)
   ================================================================ */

/* ... (your existing CSS up to the end of section 25) ... */

/* ================================================================
   26. STREAK DISPLAY (new)
   ================================================================ */
.streak-display {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-amber-400);
  background: rgba(245, 158, 11, 0.1);
  border: 1px solid rgba(245, 158, 11, 0.2);
  padding: 4px 10px;
  border-radius: var(--radius-full);
  margin-right: var(--space-2);
}

/* ================================================================
   27. DOUBT & QUIZ ACTION BUTTONS (new)
   ================================================================ */
.lesson-action-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  border-radius: var(--radius-sm);
  background: transparent;
  border: 1px solid var(--color-border);
  color: var(--color-text-muted);
  font-size: 14px;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-out);
}

.lesson-action-btn:hover {
  background: rgba(255, 255, 255, 0.06);
  color: var(--color-text-primary);
  border-color: var(--color-border-strong);
}

[data-theme="light"] .lesson-action-btn:hover {
  background: rgba(0, 0, 0, 0.04);
}

.lesson-item__actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-shrink: 0;
}

/* ================================================================
   28. LESSON MODAL HISTORY SECTIONS (new)
   ================================================================ */
.lesson-modal__history {
  margin-top: var(--space-6);
  border-top: 1px solid var(--color-border);
  padding-top: var(--space-4);
}

.lesson-modal__history h4 {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-secondary);
  margin-bottom: var(--space-2);
}

.doubts-history,
.quizzes-history {
  max-height: 200px;
  overflow-y: auto;
  margin-bottom: var(--space-4);
  padding: var(--space-2);
  background: rgba(255, 255, 255, 0.02);
  border-radius: var(--radius-sm);
}

.doubt-history-item,
.quiz-history-item {
  padding: var(--space-2) var(--space-3);
  margin-bottom: var(--space-2);
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
}

.doubt-history-item p {
  margin-bottom: 4px;
}

.doubt-history-item small {
  color: var(--color-text-muted);
}

.quiz-history-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* ================================================================
   29. DOUBT MODAL (new)
   ================================================================ */
.doubt-modal,
.quiz-options-modal {
  position: fixed; inset: 0; z-index: 500;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.doubt-modal.is-open,
.quiz-options-modal.is-open {
  opacity: 1; pointer-events: all;
}
.doubt-modal__backdrop,
.quiz-options-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.doubt-modal__box,
.quiz-options-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 500px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}
.doubt-modal__header,
.quiz-options-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}
.doubt-modal__title,
.quiz-options-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
}
.doubt-question-input {
  width: 100%;
  padding: var(--space-3);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  resize: vertical;
  margin-bottom: var(--space-4);
}
.doubt-question-input:focus {
  outline: none;
  border-color: var(--color-violet-400);
}
.doubt-answer {
  padding: var(--space-4);
  background: rgba(74, 222, 128, 0.05);
  border: 1px solid rgba(74, 222, 128, 0.2);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  margin-bottom: var(--space-4);
  white-space: pre-wrap;
}
.doubt-loading {
  text-align: center;
  color: var(--color-text-muted);
  padding: var(--space-4);
}
.doubt-footer,
.quiz-options-footer {
  display: flex;
  justify-content: flex-end;
  gap: var(--space-3);
}

/* ================================================================
   30. QUIZ OPTIONS MODAL (new)
   ================================================================ */
.quiz-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  margin-bottom: var(--space-4);
}
.quiz-options label {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  cursor: pointer;
}
.quiz-options input[type="radio"] {
  accent-color: var(--color-violet-400);
  width: 16px;
  height: 16px;
}

/* ================================================================
   THEME TOGGLE BUTTON (already present – keep as is)
   ================================================================ */
   

/* ================================================================
   LIGHT THEME OVERRIDES (already present – keep as is)
   ================================================================ */
   /* Allow answer box to expand */
.answer-box {
  max-height: none !important;
  overflow: visible !important;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Make doubt items clickable and indicate interactivity */
.doubt-item {
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.doubt-item:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.doubt-item .doubt-question {
  font-weight: 600;
  color: var(--color-text-primary);
}

.doubt-item .doubt-answer {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px dashed var(--color-border);
  color: var(--color-text-secondary);
  font-size: var(--text-sm);
  white-space: pre-wrap;
}

.doubt-item .item-date {
  font-size: 0.7rem;
  color: var(--color-text-muted);
  margin-top: 4px;
}
/* ================================================================
   Doubt Detail Modal
   ================================================================ */
.doubt-detail-modal {
  position: fixed; inset: 0; z-index: 600;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.doubt-detail-modal.is-open {
  opacity: 1; pointer-events: all;
}
.doubt-detail-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.doubt-detail-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 600px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}
.doubt-detail-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}
.doubt-detail-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
}
.doubt-detail-modal__body {
  max-height: 60vh;
  overflow-y: auto;
  padding-right: var(--space-2);
}
.doubt-detail-question,
.doubt-detail-answer {
  margin-bottom: var(--space-4);
}
.doubt-detail-question p,
.doubt-detail-answer p {
  margin-top: var(--space-2);
  line-height: 1.6;
  white-space: pre-wrap;
  word-wrap: break-word;
}
.doubt-detail-question strong,
.doubt-detail-answer strong {
  color: var(--color-text-secondary);
  font-size: var(--text-sm);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Update doubt items to indicate clickability */
.doubt-item {
  cursor: pointer;
  transition: background-color 0.2s ease;
}
.doubt-item:hover {
  background-color: rgba(255, 255, 255, 0.05);
}
[data-theme="light"] .doubt-item:hover {
  background-color: rgba(0, 0, 0, 0.05);
}
/* Make sure the modal can show long answers */
.doubt-detail-modal__body {
  max-height: 70vh;
  overflow-y: auto;
  padding-right: var(--space-2);
}

.doubt-detail-question p,
.doubt-detail-answer p {
  margin-top: var(--space-2);
  line-height: 1.6;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow-wrap: break-word;
  max-width: 100%;
}

/* Ensure no hidden overflow */
.doubt-detail-modal__box {
  max-height: 80vh;
  display: flex;
  flex-direction: column;
}

.doubt-detail-modal__body {
  flex: 1;
  overflow-y: auto;
}
/* ================================================================
   Login Modal & User Menu
   ================================================================ */
.login-modal {
  position: fixed; inset: 0; z-index: 1000;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.login-modal.is-open {
  opacity: 1; pointer-events: all;
}
.login-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.login-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 400px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}
.login-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}
.login-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
}
.login-modal__body {
  text-align: center;
}
.login-modal__body p {
  margin-bottom: var(--space-4);
  color: var(--color-text-secondary);
}
.guest-text {
  margin-top: var(--space-4);
  font-size: var(--text-sm);
}
.guest-text a {
  color: var(--color-violet-400);
  text-decoration: underline;
  cursor: pointer;
}

.user-menu {
  position: relative;
  display: inline-block;
}
.user-menu__trigger {
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
}
.user-avatar {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--color-violet-500), var(--color-amber-500));
  color: white;
  font-size: var(--text-sm);
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid rgba(255,255,255,0.1);
  overflow: hidden;
  cursor: pointer;
  transition: border-color var(--duration-fast) var(--ease-out);
}
.user-avatar:hover {
  border-color: rgba(167, 139, 250, 0.5);
}
.user-menu__dropdown {
  position: absolute;
  top: calc(100% + 10px);
  right: 0;
  min-width: 220px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-strong);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-xl);
  backdrop-filter: blur(24px);
  overflow: hidden;
  z-index: 300;
  animation: dropdownOpen var(--duration-base) var(--ease-spring) both;
}
@keyframes dropdownOpen {
  from { opacity: 0; transform: translateY(-8px) scale(0.96); }
  to   { opacity: 1; transform: translateY(0)    scale(1);    }
}
.user-menu__info {
  padding: var(--space-4);
}
.user-menu__name {
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 2px;
}
.user-menu__email {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
}
.user-menu__divider {
  height: 1px;
  background: var(--color-border);
}
.user-menu__item {
  width: 100%;
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--color-text-secondary);
  background: transparent;
  text-align: left;
  transition: all var(--duration-fast) var(--ease-out);
  cursor: pointer;
}
.user-menu__item:hover {
  background: rgba(255,255,255,0.05);
  color: var(--color-text-primary);
}
/* Hide app content when in login mode */
body.login-mode .navbar,
body.login-mode .page {
  display: none !important;
}
body.login-mode .login-modal {
  display: flex !important;
}
/* Share Modal */
.share-modal {
  position: fixed; inset: 0; z-index: 500;
  display: flex; align-items: center; justify-content: center;
  padding: var(--space-4);
  opacity: 0; pointer-events: none;
  transition: opacity var(--duration-base) var(--ease-out);
}
.share-modal.is-open {
  opacity: 1; pointer-events: all;
}
.share-modal__backdrop {
  position: absolute; inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.share-modal__box {
  position: relative; z-index: 1;
  width: 100%; max-width: 450px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
  animation: cardReveal var(--duration-slow) var(--ease-out) both;
}
.share-modal__title {
  font-family: var(--font-display);
  font-size: var(--text-lg);
  margin-bottom: var(--space-2);
}
.share-modal__input {
  width: 100%;
  padding: var(--space-3);
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text-primary);
  font-size: var(--text-sm);
  margin: var(--space-4) 0;
}
.share-modal__actions {
  display: flex;
  gap: var(--space-3);
  justify-content: flex-end;
}

/* IMPORTED badge (reuse chip--violet) */
.chip--violet {
  color: var(--color-violet-400);
  background: rgba(139, 92, 246, 0.1);
  border-color: rgba(139, 92, 246, 0.22);
  padding: 0.2rem 0.5rem;
  font-size: 0.7rem;
  margin-left: 0.5rem;
}
/* Theme‑aware logo switching */
html[data-theme="dark"] .logo-dark {
  display: block;
}
html[data-theme="dark"] .logo-light {
  display: none;
}

html[data-theme="light"] .logo-dark {
  display: none;
}
html[data-theme="light"] .logo-light {
  display: block;
}
.navbar__logo {
  background: transparent !important;
  border: none !important;
}
/* Increase logo container size */
.navbar__logo {
  width: 48px;   /* Adjust as needed – was 32px */
  height: 48px;
  background: transparent !important;  /* Remove any background/border if desired */
  border: none !important;
}

/* Theme-aware logo switching */
html[data-theme="dark"] .logo-dark {
  display: block;
}
html[data-theme="dark"] .logo-light {
  display: none;
}
html[data-theme="light"] .logo-dark {
  display: none;
}
html[data-theme="light"] .logo-light {
  display: block;
}

/* Optional: adjust navbar brand spacing if needed */
.navbar__brand {
  gap: 0;  /* Remove gap between children (only one child now) */
}
/* Ensure the navbar brand has proper spacing */
.navbar__brand {
  display: flex;
  align-items: center;
  margin-right: 16px;  /* Creates space between logo and navigation */
  padding: 0;
}

/* Logo container – original size, clean background */
.navbar__logo {
  width: 32px;
  height: 32px;
  background: transparent !important;
  border: none !important;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Theme‑aware logo switching */
html[data-theme="dark"] .logo-dark {
  display: block !important;
}
html[data-theme="dark"] .logo-light {
  display: none !important;
}
html[data-theme="light"] .logo-dark {
  display: none !important;
}
html[data-theme="light"] .logo-light {
  display: block !important;
}
.navbar__logo-wrapper {
  display: flex;
  align-items: center;
  height: 40px;          /* Fixed height */
}

.navbar__logo-wrapper img {
  height: 100%;
  width: auto;
  max-width: 120px;
  object-fit: contain;
  object-position: left center;
}

.theme-logo {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Theme switching – ensures correct logo shows */
html[data-theme="dark"] .logo-dark {
  display: block !important;
}
html[data-theme="dark"] .logo-light {
  display: none !important;
}
html[data-theme="light"] .logo-dark {
  display: none !important;
}
html[data-theme="light"] .logo-light {
  display: block !important;
}

/* Ensure no leftover styles interfere */
.navbar__brand {
  display: flex;
  align-items: center;
  text-decoration: none;
  padding: 0;
  margin: 0;
}

/* If you still have old .navbar__logo or .navbar__wordmark classes, they won't affect the new structure */
/* ===== LOGIN MODAL – PERFECT CENTERING ===== */
.login-modal {
  position: fixed;
  inset: 0;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1rem;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.login-modal.is-open {
  opacity: 1;
  pointer-events: all;
}
.login-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}
.login-modal__box.card {
  position: relative;
  z-index: 1;
  max-width: 420px;
  width: 90%;
  padding: 0.5rem 2rem 2.5rem;  /* top padding reduced from 2.5rem to 1.5rem */
  border-radius: 32px;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border);
  box-shadow: var(--shadow-xl);
  text-align: center;
}

/* Logo – perfectly centered */
.login-modal__logo-wrapper {
  display: flex;
  justify-content: center;
  margin-bottom: 0.25rem;        /* reduced from 2rem to 0.75rem */
}
.login-logo {
  width: 250px;          /* Large, as in your design */
  height: 250px;
  object-fit: contain;
}

/* Typography – all centered */
.login-modal__title {
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-text-primary);
  margin-bottom: 1.75rem;          /* slightly reduced */
  line-height: 0.1;
}
.login-modal__subtitle {
  font-size: 1rem;
  color: var(--color-text-secondary);
  margin-bottom: 2rem;
  max-width: 280px;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.6;
}

/* Google button – pill, full width */
.btn--google {
  background: #ffffff;
  color: #3c4043;
  border: 1px solid #dadce0;
  border-radius: 40px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 14px 20px;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.2s ease;
  margin-bottom: 1.5rem;
}
.btn--google:hover {
  background: #f8f9fa;
  border-color: #d2d4d7;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  transform: translateY(-1px);
}
.btn--google svg {
  flex-shrink: 0;
}

/* Guest link – centered, subtle */
.login-modal__guest {
  font-size: 0.9rem;
  color: var(--color-text-muted);
}
.login-modal__guest a {
  color: var(--color-violet-400);
  text-decoration: none;
  font-weight: 500;
  transition: color 0.2s;
}
.login-modal__guest a:hover {
  color: var(--color-violet-300);
  text-decoration: underline;
}
/* ================================================================
   RESPONSIVE DESIGN – Mobile First
   ================================================================ */

/* Tablets and small desktops (up to 768px) */
@media (max-width: 768px) {
  .navbar__inner {
    gap: var(--space-3);
    padding: 0 var(--space-3);
  }
  
  .navbar__link span:not(.navbar__count) {
    display: none; /* Hide text labels on smaller screens */
  }
  
  .navbar__link {
    padding: 7px var(--space-2);
  }
  
  .hero__title {
    font-size: var(--text-2xl);
  }
  
  .hero__subtitle {
    font-size: var(--text-base);
  }
  
  .field-row {
    grid-template-columns: 1fr;
  }
  
  .library-grid {
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  }
  
  .dashboard-stats {
    gap: var(--space-2);
  }
  
  .stat-card {
    padding: var(--space-3);
  }
  
  .stat-card__value {
    font-size: var(--text-lg);
  }
}

/* Phones (up to 480px) */
@media (max-width: 480px) {
  /* Navbar */
  .navbar__inner {
    flex-wrap: wrap;
    justify-content: space-between;
    padding: var(--space-2) var(--space-3);
  }
  
  .navbar__brand {
    order: 1;
  }
  
  .navbar__nav {
    order: 3;
    width: 100%;
    justify-content: space-around;
    margin-top: var(--space-2);
  }
  
  .navbar__actions {
    order: 2;
    margin-left: 0;
    gap: var(--space-2);
  }
  
  .navbar__link {
    flex: 1;
    text-align: center;
    padding: 7px 0;
  }
  
  .streak-display {
    font-size: var(--text-xs);
    padding: 2px 6px;
  }
  
  /* Hero */
  .hero {
    padding: var(--space-4) 0 var(--space-6);
  }
  
  .hero__title {
    font-size: var(--text-xl);
  }
  
  .hero__subtitle {
    font-size: var(--text-sm);
  }
  
  /* Cards */
  .card {
    padding: var(--space-4);
  }
  
  .result-card__stats {
    flex-direction: column;
    gap: var(--space-2);
  }
  
  .stat-pill {
    width: 100%;
    justify-content: center;
  }
  
  /* Library */
  .library-grid {
    grid-template-columns: 1fr;
  }
  
  .library-toolbar {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-field {
    max-width: 100%;
  }
  
  .library-toolbar__meta {
    margin-left: 0;
    text-align: center;
  }
  
  /* Dashboard */
  .dashboard-stats {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .progress-ring {
    width: 60px;
    height: 60px;
  }
  
  .progress-ring__svg {
    width: 60px;
    height: 60px;
  }
  
  .lesson-item {
    padding: var(--space-3);
    gap: var(--space-2);
  }
  
  .lesson-item__title {
    font-size: var(--text-xs);
  }
  
  .lesson-item__module {
    font-size: 0.7rem;
  }
  
  .lesson-item__tag {
    padding: 2px 6px;
    font-size: 0.65rem;
  }
  
  /* Modals */
  .lesson-modal__box,
  .quiz-modal__box,
  .share-modal__box {
    width: 95%;
    padding: var(--space-4);
  }
  
  .action-cards {
    grid-template-columns: 1fr;
  }
  
  .library-tabs .tab-btn {
    padding: var(--space-2) var(--space-2);
    font-size: var(--text-xs);
  }
  
  /* Login modal */
  .login-modal__box.card {
    padding: 2rem 1.5rem;
  }
  
  .login-logo {
    width: 80px;
    height: 80px;
  }
  
  .login-modal__title {
    font-size: 1.5rem;
  }
  
  .btn--google {
    padding: 12px 16px;
  }
}

/* Very small phones (up to 360px) */
@media (max-width: 360px) {
  .navbar__link {
    font-size: var(--text-xs);
  }
  
  .navbar__link svg {
    width: 12px;
    height: 12px;
  }
  
  .streak-display {
    display: none; /* Hide streak on very tiny screens to save space */
  }
  
  .dashboard-stats {
    grid-template-columns: 1fr;
  }
  
  .lesson-item {
    flex-wrap: wrap;
  }
  
  .lesson-item__actions {
    width: 100%;
    justify-content: flex-end;
    margin-top: var(--space-1);
  }
}